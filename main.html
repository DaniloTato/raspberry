<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Paho MQTT JavaScript Example</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.js" type="text/javascript"></script>
</head>
<body>
    <h1>Mosquitto MQTT</h1>
    <button onclick="sendGreenOn()">Send green_on</button>
    <button onclick="sendGreenOff()">Send green_off</button>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const client = new Paho.MQTT.Client("broker.hivemq.com", 8000, "clientId-" + Math.random());

            client.onConnectionLost = (responseObject) => {
                if (responseObject.errorCode !== 0) {
                    console.log("Connection Lost:", responseObject.errorMessage);
                }
            };

            client.onMessageArrived = (message) => {
                console.log("Message Arrived:", message.payloadString);
            };

            client.connect({
                onSuccess: () => {
                    console.log("Connected to broker");
                    client.subscribe("test/topic"); // Replace with your topic
                },
                onFailure: (error) => {
                    console.log("Connection Failed:", error.errorMessage);
                }
            });

            window.sendGreenOn = function() {
                const message = new Paho.MQTT.Message("green_on");
                message.destinationName = "test/topic";
                client.send(message);
                console.log("Message Sent: green_on");
            };

            window.sendGreenOff = function() {
                const message = new Paho.MQTT.Message("green_off");
                message.destinationName = "test/topic";
                client.send(message);
                console.log("Message Sent: green_off");
            };
        });
    </script>
</body>
</html>